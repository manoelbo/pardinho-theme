customElements.get("quick-order-list-remove-button")||customElements.define("quick-order-list-remove-button",class extends BulkAdd{constructor(){super(),this.addEventListener("click",(t=>{t.preventDefault(),this.startQueue(this.dataset.index,0)}))}}),customElements.get("quick-order-list-remove-all-button")||customElements.define("quick-order-list-remove-all-button",class extends HTMLElement{constructor(){super(),this.quickOrderList=this.closest("quick-order-list");const t=this.quickOrderList.querySelectorAll("[data-quantity-variant-id]"),e={};let i=!1;t.forEach((t=>{parseInt(t.dataset.cartQuantity)>0&&(i=!0,e[parseInt(t.dataset.quantityVariantId)]=0)})),i||this.classList.add("hidden"),this.actions={confirm:"confirm",remove:"remove",cancel:"cancel"},this.addEventListener("click",(t=>{t.preventDefault(),this.dataset.action===this.actions.confirm?this.toggleConfirmation(!1,!0):this.dataset.action===this.actions.remove?(this.quickOrderList.updateMultipleQty(e),this.toggleConfirmation(!0,!1)):this.dataset.action===this.actions.cancel&&this.toggleConfirmation(!0,!1)}))}toggleConfirmation(t,e){this.quickOrderList.querySelector(".quick-order-list-total__confirmation").classList.toggle("hidden",t),this.quickOrderList.querySelector(".quick-order-list-total__info").classList.toggle("hidden",e)}}),customElements.get("quick-order-list")||customElements.define("quick-order-list",class extends BulkAdd{constructor(){super(),this.cart=document.querySelector("cart-drawer"),this.quickOrderListId=`${this.dataset.section}-${this.dataset.productId}`,this.defineInputsAndQuickOrderTable(),this.variantItemStatusElement=document.getElementById("shopping-cart-variant-item-status");const t=this.querySelector("form");this.inputFieldHeight=this.querySelector(".variant-item__quantity-wrapper").offsetHeight,this.isListInsideModal=document.querySelector(".quick-add-bulk"),this.stickyHeaderElement=document.querySelector("sticky-header"),this.getTableHead(),this.getTotalBar(),this.stickyHeaderElement&&(this.stickyHeader={height:this.stickyHeaderElement.offsetHeight,type:`${this.stickyHeaderElement.getAttribute("data-sticky-type")}`}),this.getTotalBar()&&(this.totalBarPosition=window.innerHeight-this.getTotalBar().offsetHeight,window.addEventListener("resize",(()=>{this.totalBarPosition=window.innerHeight-this.getTotalBar().offsetHeight,this.stickyHeader.height=this.stickyHeaderElement?this.stickyHeaderElement.offsetHeight:0})));const e=new URLSearchParams(window.location.search);window.pageNumber=decodeURIComponent(e.get("page")||""),t.addEventListener("submit",this.onSubmit.bind(this)),this.addMultipleDebounce()}cartUpdateUnsubscriber=void 0;onSubmit(t){t.preventDefault()}connectedCallback(){this.cartUpdateUnsubscriber=subscribe(PUB_SUB_EVENTS.cartUpdate,(t=>{const e=[];this.querySelectorAll(".variant-item").forEach((t=>{e.push(parseInt(t.dataset.variantId))})),t.source!==this.quickOrderListId&&t.cartData.items?.some((t=>e.includes(t.variant_id)))&&this.refresh().then((()=>{this.defineInputsAndQuickOrderTable(),this.addMultipleDebounce()}))})),this.sectionId=this.dataset.section}disconnectedCallback(){this.cartUpdateUnsubscriber?.()}defineInputsAndQuickOrderTable(){this.allInputsArray=Array.from(this.querySelectorAll('input[type="number"]')),this.quickOrderListTable=this.querySelector(".quick-order-list__table"),this.quickOrderListTable.addEventListener("focusin",this.switchVariants.bind(this))}onChange(t){const e=parseInt(t.target.value);this.cleanErrorMessageOnType(t),0==e?this.startQueue(t.target.dataset.index,e):this.validateQuantity(t)}cleanErrorMessageOnType(t){t.target.addEventListener("keydown",(()=>{t.target.setCustomValidity(" "),t.target.reportValidity()}))}validateInput(t){return t.max?0==parseInt(t.value)||parseInt(t.value)>=parseInt(t.dataset.min)&&parseInt(t.value)<=parseInt(t.max)&&parseInt(t.value)%parseInt(t.step)==0:0==parseInt(t.value)||parseInt(t.value)>=parseInt(t.dataset.min)&&parseInt(t.value)%parseInt(t.step)==0}refresh(){return new Promise(((t,e)=>{fetch(`${this.getSectionsUrl()}?section_id=${this.sectionId}`).then((t=>t.text())).then((e=>{const i=(new DOMParser).parseFromString(e,"text/html").querySelector(`#${this.quickOrderListId}`);i&&(this.innerHTML=i.innerHTML),t()})).catch((t=>{console.error(t),e(t)}))}))}getSectionsToRender(){return[{id:this.quickOrderListId,section:document.getElementById(this.quickOrderListId).dataset.section,selector:`#${this.quickOrderListId} .js-contents`},{id:"cart-icon-bubble",section:"cart-icon-bubble",selector:".shopify-section"},{id:`quick-order-list-live-region-text-${this.dataset.productId}`,section:"cart-live-region-text",selector:".shopify-section"},{id:`quick-order-list-total-${this.dataset.productId}-${this.dataset.section}`,section:document.getElementById(this.quickOrderListId).dataset.section,selector:`#${this.quickOrderListId} .quick-order-list__total`},{id:"CartDrawer",selector:"#CartDrawer",section:"cart-drawer"}]}addMultipleDebounce(){this.querySelectorAll("quantity-input").forEach((t=>{const e=debounce((t=>{this.onChange(t)}),100);t.addEventListener("change",e.bind(this))}))}renderSections(t,e){this.ids.push(e);0===this.queue.filter((t=>e.includes(t.id))).length&&(this.getSectionsToRender().forEach((e=>{const i=document.getElementById(e.id);i&&i.parentElement&&i.parentElement.classList.contains("drawer")&&(t.items.length>0?i.parentElement.classList.remove("is-empty"):i.parentElement.classList.add("is-empty"),setTimeout((()=>{document.querySelector("#CartDrawer-Overlay").addEventListener("click",this.cart.close.bind(this.cart))})));const s=i&&i.querySelector(e.selector)?i.querySelector(e.selector):i;s&&(e.selector===`#${this.quickOrderListId} .js-contents`&&this.ids.length>0?this.ids.flat().forEach((i=>{s.querySelector(`#Variant-${i}`).innerHTML=this.getSectionInnerHTML(t.sections[e.section],`#Variant-${i}`)})):s.innerHTML=this.getSectionInnerHTML(t.sections[e.section],e.selector))})),this.defineInputsAndQuickOrderTable(),this.addMultipleDebounce(),this.ids=[])}getTableHead(){return document.querySelector(".quick-order-list__table thead")}getTotalBar(){return this.querySelector(".quick-order-list__total")}scrollQuickOrderListTable(){const t=this.variantListInput.getBoundingClientRect().top,e=this.variantListInput.getBoundingClientRect().bottom;if(this.isListInsideModal){const i=e>this.getTotalBar().getBoundingClientRect().top,s=t<this.getTableHead().getBoundingClientRect().bottom;(i||s)&&this.scrollToCenter()}else{const i=this.stickyHeaderElement&&this.stickyHeaderElement.getBoundingClientRect().bottom,s=e>this.totalBarPosition,r=e<this.inputFieldHeight,n=this.stickyHeaderElement&&"on-scroll-up"!==this.stickyHeader.type&&this.stickyHeader.height>t,a=this.stickyHeaderElement&&"on-scroll-up"===this.stickyHeader.type&&this.stickyHeader.height>t&&i>0;(s||r||n||a)&&this.scrollToCenter()}}scrollToCenter(){this.variantListInput.scrollIntoView({block:"center",behavior:"smooth"})}switchVariants(t){"INPUT"===t.target.tagName&&(this.variantListInput=t.target,this.variantListInput.select(),1!==this.allInputsArray.length?(this.variantListInput.addEventListener("keydown",(t=>{if("Enter"===t.key&&(t.preventDefault(),t.target.blur(),this.validateInput(t.target))){const e=this.allInputsArray.indexOf(t.target);if(this.lastKey=t.shiftKey,t.shiftKey){const t=e-1,i=this.allInputsArray[t]||this.allInputsArray[this.allInputsArray.length-1];this.lastElement=i.dataset.index,i.select()}else{const t=e+1;(this.allInputsArray[t]||this.allInputsArray[0]).select()}}})),this.scrollQuickOrderListTable()):this.variantListInput.addEventListener("keydown",(t=>{"Enter"===t.key&&(t.preventDefault(),t.target.blur())})))}updateMultipleQty(t){this.querySelector(".variant-remove-total .loading__spinner")?.classList.remove("hidden");const e=Object.keys(t),i=JSON.stringify({updates:t,sections:this.getSectionsToRender().map((t=>t.section)),sections_url:this.dataset.url});this.updateMessage(),this.setErrorMessage(),fetch(`${routes.cart_update_url}`,{...fetchConfig(),body:i}).then((t=>t.text())).then((t=>{const i=JSON.parse(t);this.renderSections(i,e),publish(PUB_SUB_EVENTS.cartUpdate,{source:this.quickOrderListId,cartData:i})})).catch((()=>{this.setErrorMessage(window.cartStrings.error)})).finally((()=>{this.querySelector(".variant-remove-total .loading__spinner")?.classList.add("hidden"),this.requestStarted=!1}))}setErrorMessage(t=null){this.errorMessageTemplate=this.errorMessageTemplate??document.getElementById(`QuickOrderListErrorTemplate-${this.dataset.productId}`).cloneNode(!0);document.querySelectorAll(".quick-order-list-error").forEach((e=>{if(e.innerHTML="",!t)return;const i=this.errorMessageTemplate.cloneNode(!0);i.content.querySelector(".quick-order-list-error-message").innerText=t,e.appendChild(i.content)}))}updateMessage(t=null){const e=this.querySelectorAll(".quick-order-list__message-text"),i=this.querySelectorAll(".quick-order-list__message-icon");if(null===t||isNaN(t))return e.forEach((t=>t.innerHTML="")),void i.forEach((t=>t.classList.add("hidden")));const s=t<0,r=Math.abs(t),n=s?1===r?window.quickOrderListStrings.itemRemoved:window.quickOrderListStrings.itemsRemoved:1===t?window.quickOrderListStrings.itemAdded:window.quickOrderListStrings.itemsAdded;e.forEach((t=>t.innerHTML=n.replace("[quantity]",r))),s||i.forEach((t=>t.classList.remove("hidden")))}updateError(t,e){let i="";i=void 0===t?window.cartStrings.error:window.cartStrings.quantityError.replace("[quantity]",t),this.updateLiveRegions(e,i)}cleanErrors(t){}updateLiveRegions(t,e){const i=document.getElementById(`Quick-order-list-item-error-desktop-${t}`),s=document.getElementById(`Quick-order-list-item-error-mobile-${t}`);i&&(i.querySelector(".variant-item__error-text").innerHTML=e,i.closest("tr").classList.remove("hidden")),s&&(s.querySelector(".variant-item__error-text").innerHTML=e),this.variantItemStatusElement.setAttribute("aria-hidden",!0);const r=document.getElementById("quick-order-list-live-region-text");r.setAttribute("aria-hidden",!1),setTimeout((()=>{r.setAttribute("aria-hidden",!0)}),1e3)}toggleLoading(t,e){const i=this.querySelectorAll(`#Variant-${t} .loading__spinner`),s=this.querySelector(`#Variant-${t}`);e?(s.classList.add("quick-order-list__container--disabled"),[...i].forEach((t=>t.classList.remove("hidden"))),this.variantItemStatusElement.setAttribute("aria-hidden",!1)):(s.classList.remove("quick-order-list__container--disabled"),i.forEach((t=>t.classList.add("hidden"))))}});